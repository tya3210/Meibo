<!DOCTYPE html>
<html>
<head>
<title>部活出欠確認</title>
<style>
body { font-family: sans-serif; }
.admin-panel { display: none; }
</style>
</head>
<body>
<h1>部活出欠確認</h1>

<div id="password-form">
  <label for="password">パスワード:</label>
  <input type="password" id="password">
  <button onclick="checkPassword()">ログイン</button>
</div>

<div id="instrument-select" style="display: none;">
  <label for="instrument">楽器を選択:</label>
  <select id="instrument">
    <option value="フルート">フルート</option>
    <option value="クラリネット">クラリネット</option>
    <option value="オーボエ">オーボエ</option>
    <option value="サックス">サックス</option>
    <option value="トランペット">トランペット</option>
    <option value="ホルン">ホルン</option>
    <option value="トロンボーン">トロンボーン</option>
    <option value="ユーフォニアム">ユーフォニアム</option>
    <option value="コントラバス">コントラバス</option>
    <option value="チューバ">チューバ</option>
    <option value="パーカッション">パーカッション</option>
  </select>
  <button onclick="showAttendance()">選択</button>
</div>

<div id="attendance-form" style="display: none;">
  <h2>出欠確認</h2>
  <ul id="member-list"></ul>
  <input type="text" id="new-member-name" placeholder="新しい部員名">
  <button onclick="addMember()">追加</button>
  <button onclick="toggleAdmin()">管理者モード</button>
</div>

<div class="admin-panel">
  <h2>管理者パネル</h2>
  <ul id="admin-member-list"></ul>
</div>

<script>
const correctPassword = "Brassband";
let isAdmin = false;
let currentInstrument = "";
let members = {};

function checkPassword() {
  const password = document.getElementById("password").value;
  if (password === correctPassword) {
    document.getElementById("password-form").style.display = "none";
    document.getElementById("instrument-select").style.display = "block";
  } else {
    alert("パスワードが違います");
  }
}

function showAttendance() {
  currentInstrument = document.getElementById("instrument").value;
  if (!members[currentInstrument]) {
    members[currentInstrument] = [];
  }
  document.getElementById("instrument-select").style.display = "none";
  document.getElementById("attendance-form").style.display = "block";
  updateMemberList();
}

function updateMemberList() {
  const memberList = document.getElementById("member-list");
  memberList.innerHTML = "";
  members[currentInstrument].forEach(member => {
    const li = document.createElement("li");
    li.textContent = member;
    memberList.appendChild(li);
  });
}

function addMember() {
  const name = document.getElementById("new-member-name").value;
  if (name) {
    members[currentInstrument].push(name);
    document.getElementById("new-member-name").value = "";
    updateMemberList();
    updateAdminMemberList();
  }
}

function toggleAdmin() {
  isAdmin = !isAdmin;
  const adminPanels = document.querySelectorAll(".admin-panel");
  adminPanels.forEach(panel => {
    panel.style.display = isAdmin ? "block" : "none";
  });
  updateAdminMemberList();
}

function updateAdminMemberList() {
    if (!isAdmin) return;
    const adminMemberList = document.getElementById("admin-member-list");
    adminMemberList.innerHTML = "";
    Object.keys(members).forEach(instrument => {
        const instrumentHeader = document.createElement("h3");
        instrumentHeader.textContent = instrument;
        adminMemberList.appendChild(instrumentHeader);

        members[instrument].forEach((member, index) => {
            const li = document.createElement("li");
            li.textContent = member;

            const deleteButton = document.createElement("button");
            deleteButton.textContent = "削除";
            deleteButton.onclick = () => {
                members[instrument].splice(index, 1);
                updateAdminMemberList();
                updateMemberList();
            };
            li.appendChild(deleteButton);

            const editButton = document.createElement("button");
            editButton.textContent = "編集";
            editButton.onclick = () => {
                const newName = prompt("新しい部員名を入力してください", member);
                if (newName) {
                    members[instrument][index] = newName;
                    updateAdminMemberList();
                    updateMemberList();
                }
            };
            li.appendChild(editButton);

            adminMemberList.appendChild(li);
        });
    });
}
</script>
</body>
</html>
